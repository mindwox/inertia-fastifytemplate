{"version":3,"file":"index.js","sources":["../src/modal.js","../src/events.js","../src/url.js","../src/inertia.js","../src/debounce.js","../src/shouldIntercept.js"],"sourcesContent":["export default {\n  modal: null,\n  listener: null,\n\n  show(html) {\n    if (typeof html === 'object') {\n      html = `All Inertia requests must receive a valid Inertia response, however a plain JSON response was received.<hr>${JSON.stringify(html)}`\n    }\n\n    let page = document.createElement('html')\n    page.innerHTML = html\n    page.querySelectorAll('a').forEach(a => a.setAttribute('target', '_top'))\n\n    this.modal = document.createElement('div')\n    this.modal.style.position = 'fixed'\n    this.modal.style.width = '100vw'\n    this.modal.style.height = '100vh'\n    this.modal.style.padding = '50px'\n    this.modal.style.boxSizing = 'border-box'\n    this.modal.style.backgroundColor = 'rgba(0, 0, 0, .6)'\n    this.modal.style.zIndex = 200000\n    this.modal.addEventListener('click', () => this.hide())\n\n    let iframe = document.createElement('iframe')\n    iframe.style.backgroundColor = 'white'\n    iframe.style.borderRadius = '5px'\n    iframe.style.width = '100%'\n    iframe.style.height = '100%'\n    this.modal.appendChild(iframe)\n\n    document.body.prepend(this.modal)\n    document.body.style.overflow = 'hidden'\n    iframe.contentWindow.document.open()\n    iframe.contentWindow.document.write(page.outerHTML)\n    iframe.contentWindow.document.close()\n\n    this.listener = this.hideOnEscape.bind(this)\n    document.addEventListener('keydown', this.listener)\n  },\n\n  hide() {\n    this.modal.outerHTML = ''\n    this.modal = null\n    document.body.style.overflow = 'visible'\n    document.removeEventListener('keydown', this.listener)\n  },\n\n  hideOnEscape(event) {\n    if (event.keyCode === 27) {\n      this.hide()\n    }\n  },\n}\n","function fireEvent(name, options) {\n  return document.dispatchEvent(\n    new CustomEvent(`inertia:${name}`, options),\n  )\n}\n\nexport function fireBeforeEvent(visit) {\n  return fireEvent('before', { cancelable: true, detail: { visit } } )\n}\n\nexport function fireErrorEvent(error) {\n  return fireEvent('error', { cancelable: true, detail: { error } })\n}\n\nexport function fireFinishEvent(visit) {\n  return fireEvent('finish', { detail: { visit } } )\n}\n\nexport function fireInvalidEvent(response) {\n  return fireEvent('invalid', { cancelable: true, detail: { response } })\n}\n\nexport function fireNavigateEvent(page) {\n  return fireEvent('navigate', { detail: { page } })\n}\n\nexport function fireProgressEvent(progress) {\n  return fireEvent('progress', { detail: { progress } })\n}\n\nexport function fireStartEvent(visit) {\n  return fireEvent('start', { detail: { visit } } )\n}\n\nexport function fireSuccessEvent(page) {\n  return fireEvent('success', { detail: { page } })\n}\n","import qs from 'qs'\nimport deepmerge from 'deepmerge'\n\nexport function hrefToUrl(href) {\n  return new URL(href, window.location)\n}\n\nexport function mergeDataIntoQueryString(method, url, data) {\n  if (method === 'get' && Object.keys(data).length) {\n    url.search = qs.stringify(deepmerge(qs.parse(url.search, { ignoreQueryPrefix: true }), data), { encode: false })\n    data = {}\n  }\n  return [url, data]\n}\n\nexport function urlWithoutHash(url) {\n  url = new URL(url.href)\n  url.hash = ''\n  return url\n}\n","import Axios from 'axios'\nimport debounce from './debounce'\nimport modal from './modal'\nimport { fireBeforeEvent, fireErrorEvent, fireFinishEvent, fireInvalidEvent, fireNavigateEvent, fireProgressEvent, fireStartEvent, fireSuccessEvent } from './events'\nimport { hrefToUrl, mergeDataIntoQueryString, urlWithoutHash } from './url'\n\nexport default {\n  resolveComponent: null,\n  swapComponent: null,\n  transformProps: null,\n  activeVisit: null,\n  visitId: null,\n  page: null,\n\n  init({ initialPage, resolveComponent, swapComponent, transformProps }) {\n    this.resolveComponent = resolveComponent\n    this.swapComponent = swapComponent\n    this.transformProps = transformProps\n    this.handleInitialPageVisit(initialPage)\n    this.setupEventListeners()\n  },\n\n  handleInitialPageVisit(page) {\n    if (this.isBackForwardVisit()) {\n      this.handleBackForwardVisit(page)\n    } else if (this.isLocationVisit()) {\n      this.handleLocationVisit(page)\n    } else {\n      page.url += window.location.hash\n      this.setPage(page)\n    }\n    fireNavigateEvent(page)\n  },\n\n  setupEventListeners() {\n    window.addEventListener('popstate', this.handlePopstateEvent.bind(this))\n    document.addEventListener('scroll', debounce(this.handleScrollEvent.bind(this), 100), true)\n  },\n\n  scrollRegions() {\n    return document.querySelectorAll('[scroll-region]')\n  },\n\n  handleScrollEvent(event) {\n    if (typeof event.target.hasAttribute === 'function' && event.target.hasAttribute('scroll-region')) {\n      this.saveScrollPositions()\n    }\n  },\n\n  saveScrollPositions() {\n    this.replaceState({\n      ...this.page,\n      scrollRegions: Array.prototype.slice.call(this.scrollRegions()).map(region => {\n        return {\n          top: region.scrollTop,\n          left: region.scrollLeft,\n        }\n      }),\n    })\n  },\n\n  resetScrollPositions() {\n    document.documentElement.scrollTop = 0\n    document.documentElement.scrollLeft = 0\n    this.scrollRegions().forEach(region => {\n      region.scrollTop = 0\n      region.scrollLeft = 0\n    })\n    this.saveScrollPositions()\n\n    if (window.location.hash) {\n      document.getElementById(window.location.hash.slice(1))?.scrollIntoView()\n    }\n  },\n\n  restoreScrollPositions() {\n    if (this.page.scrollRegions) {\n      this.scrollRegions().forEach((region, index) => {\n        region.scrollTop = this.page.scrollRegions[index].top\n        region.scrollLeft = this.page.scrollRegions[index].left\n      })\n    }\n  },\n\n  isBackForwardVisit() {\n    return window.history.state\n      && window.performance\n      && window.performance.getEntriesByType('navigation').length\n      && window.performance.getEntriesByType('navigation')[0].type === 'back_forward'\n  },\n\n  handleBackForwardVisit(page) {\n    window.history.state.version = page.version\n    this.setPage(window.history.state, { preserveScroll: true }).then(() => {\n      this.restoreScrollPositions()\n    })\n  },\n\n  locationVisit(url, preserveScroll) {\n    try {\n      window.sessionStorage.setItem('inertiaLocationVisit', JSON.stringify({ preserveScroll }))\n      window.location.href = url.href\n      if (urlWithoutHash(window.location).href === urlWithoutHash(url).href) {\n        window.location.reload()\n      }\n    } catch (error) {\n      return false\n    }\n  },\n\n  isLocationVisit() {\n    try {\n      return window.sessionStorage.getItem('inertiaLocationVisit') !== null\n    } catch (error) {\n      return false\n    }\n  },\n\n  handleLocationVisit(page) {\n    const locationVisit = JSON.parse(window.sessionStorage.getItem('inertiaLocationVisit'))\n    window.sessionStorage.removeItem('inertiaLocationVisit')\n    page.url += window.location.hash\n    page.rememberedState = window.history.state?.rememberedState ?? {}\n    page.scrollRegions = window.history.state?.scrollRegions ?? []\n    this.setPage(page, { preserveScroll: locationVisit.preserveScroll }).then(() => {\n      if (locationVisit.preserveScroll) {\n        this.restoreScrollPositions()\n      }\n    })\n  },\n\n  isLocationVisitResponse(response) {\n    return response && response.status === 409 && response.headers['x-inertia-location']\n  },\n\n  isInertiaResponse(response) {\n    return response?.headers['x-inertia']\n  },\n\n  createVisitId() {\n    this.visitId = {}\n    return this.visitId\n  },\n\n  cancelVisit(visit, { cancelled = false, interrupted = false }) {\n    if (visit && !visit.completed && !visit.cancelled && !visit.interrupted) {\n      visit.cancelToken.cancel()\n      visit.onCancel()\n      visit.completed = false\n      visit.cancelled = cancelled\n      visit.interrupted = interrupted\n      fireFinishEvent(visit)\n      visit.onFinish()\n    }\n  },\n\n  finishVisit(visit) {\n    if (!visit.cancelled && !visit.interrupted) {\n      visit.completed = true\n      visit.cancelled = false\n      visit.interrupted = false\n      fireFinishEvent(visit)\n      visit.onFinish()\n    }\n  },\n\n  visit(url, {\n    method = 'get',\n    data = {},\n    replace = false,\n    preserveScroll = false,\n    preserveState = false,\n    only = [],\n    headers = {},\n    onCancelToken = () => ({}),\n    onBefore = () => ({}),\n    onStart = () => ({}),\n    onProgress = () => ({}),\n    onFinish = () => ({}),\n    onCancel = () => ({}),\n    onSuccess = () => ({}),\n  } = {}) {\n    method = method.toLowerCase();\n    [url, data] = mergeDataIntoQueryString(method, hrefToUrl(url), data)\n    const visit = { url, method, data, replace, preserveScroll, preserveState, only, headers, onCancelToken, onBefore, onStart, onProgress, onFinish, onCancel, onSuccess }\n\n    if (onBefore(visit) === false || !fireBeforeEvent(visit)) {\n      return\n    }\n\n    this.cancelVisit(this.activeVisit, { interrupted: true })\n    this.saveScrollPositions()\n\n    let visitId = this.createVisitId()\n    this.activeVisit = visit\n    this.activeVisit.cancelToken = Axios.CancelToken.source()\n    onCancelToken({ cancel: () => this.cancelVisit(this.activeVisit, { cancelled: true }) })\n\n    fireStartEvent(visit)\n    onStart(visit)\n\n    return new Proxy(\n      Axios({\n        method,\n        url: urlWithoutHash(url).href,\n        data: method === 'get' ? {} : data,\n        params: method === 'get' ? data : {},\n        cancelToken: this.activeVisit.cancelToken.token,\n        headers: {\n          ...headers,\n          Accept: 'text/html, application/xhtml+xml',\n          'X-Requested-With': 'XMLHttpRequest',\n          'X-Inertia': true,\n          ...(only.length ? {\n            'X-Inertia-Partial-Component': this.page.component,\n            'X-Inertia-Partial-Data': only.join(','),\n          } : {}),\n          ...(this.page.version ? { 'X-Inertia-Version': this.page.version } : {}),\n        },\n        onUploadProgress: progress => {\n          progress.percentage = Math.round(progress.loaded / progress.total * 100)\n          fireProgressEvent(progress)\n          onProgress(progress)\n        },\n      }).then(response => {\n        if (!this.isInertiaResponse(response)) {\n          return Promise.reject({ response })\n        }\n        if (only.length && response.data.component === this.page.component) {\n          response.data.props = { ...this.page.props, ...response.data.props }\n        }\n        const responseUrl = hrefToUrl(response.data.url)\n        if (url.hash && !responseUrl.hash && urlWithoutHash(url).href === responseUrl.href) {\n          responseUrl.hash = url.hash\n          response.data.url = responseUrl.href\n        }\n        return this.setPage(response.data, { visitId, replace, preserveScroll, preserveState })\n      }).then(() => {\n        fireSuccessEvent(this.page)\n        return onSuccess(this.page)\n      }).catch(error => {\n        if (this.isInertiaResponse(error.response)) {\n          return this.setPage(error.response.data, { visitId })\n        } else if (this.isLocationVisitResponse(error.response)) {\n          let locationUrl = hrefToUrl(error.response.headers['x-inertia-location'])\n          if (url.hash && !locationUrl.hash && urlWithoutHash(url).href === locationUrl.href) {\n            locationUrl.hash = url.hash\n          }\n          this.locationVisit(locationUrl, preserveScroll)\n        } else if (error.response) {\n          if (fireInvalidEvent(error.response)) {\n            modal.show(error.response.data)\n          }\n        } else {\n          return Promise.reject(error)\n        }\n      }).then(() => {\n        this.finishVisit(visit)\n      }).catch(error => {\n        if (!Axios.isCancel(error)) {\n          const throwError = fireErrorEvent(error)\n          this.finishVisit(visit)\n          if (throwError) {\n            return Promise.reject(error)\n          }\n        }\n      }), {\n        get: function(target, prop) {\n          if (['then', 'catch', 'finally'].includes(prop)) {\n            console.warn('Inertia.js visit promises have been deprecated and will be removed in a future release. Please use the new visit event callbacks instead.\\n\\nLearn more at https://inertiajs.com/manual-visits#promise-deprecation')\n          }\n          return typeof target[prop] === 'function'\n            ? target[prop].bind(target)\n            : target[prop]\n        },\n      },\n    )\n  },\n\n  setPage(page, { visitId = this.createVisitId(), replace = false, preserveScroll = false, preserveState = false } = {}) {\n    return Promise.resolve(this.resolveComponent(page.component)).then(component => {\n      if (visitId === this.visitId) {\n        page.scrollRegions = page.scrollRegions || []\n        page.rememberedState = page.rememberedState || {}\n        preserveState = typeof preserveState === 'function' ? preserveState(page) : preserveState\n        preserveScroll = typeof preserveScroll === 'function' ? preserveScroll(page) : preserveScroll\n        replace = replace || hrefToUrl(page.url).href === window.location.href\n        replace ? this.replaceState(page) : this.pushState(page)\n        const clone = JSON.parse(JSON.stringify(page))\n        clone.props = this.transformProps(clone.props)\n        this.swapComponent({ component, page: clone, preserveState }).then(() => {\n          if (!preserveScroll) {\n            this.resetScrollPositions()\n          }\n          if (!replace) {\n            fireNavigateEvent(page)\n          }\n        })\n      }\n    })\n  },\n\n  pushState(page) {\n    this.page = page\n    window.history.pushState(page, '', page.url)\n  },\n\n  replaceState(page) {\n    this.page = page\n    window.history.replaceState(page, '', page.url)\n  },\n\n  handlePopstateEvent(event) {\n    if (event.state !== null) {\n      const page = event.state\n      let visitId = this.createVisitId()\n      return Promise.resolve(this.resolveComponent(page.component)).then(component => {\n        if (visitId === this.visitId) {\n          this.page = page\n          this.swapComponent({ component, page, preserveState: false }).then(() => {\n            this.restoreScrollPositions()\n            fireNavigateEvent(page)\n          })\n        }\n      })\n    } else {\n      const url = hrefToUrl(this.page.url)\n      url.hash = window.location.hash\n      this.replaceState({ ...this.page, url: url.href })\n      this.resetScrollPositions()\n    }\n  },\n\n  get(url, data = {}, options = {}) {\n    return this.visit(url, { ...options, method: 'get', data })\n  },\n\n  reload(options = {}) {\n    return this.visit(window.location.href, { ...options, preserveScroll: true, preserveState: true })\n  },\n\n  replace(url, options = {}) {\n    console.warn(`Inertia.replace() has been deprecated and will be removed in a future release. Please use Inertia.${options.method ?? 'get'}() instead.`)\n    return this.visit(url, { preserveState: true, ...options, replace: true })\n  },\n\n  post(url, data = {}, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'post', data })\n  },\n\n  put(url, data = {}, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'put', data })\n  },\n\n  patch(url, data = {}, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'patch', data })\n  },\n\n  delete(url, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'delete' })\n  },\n\n  remember(data, key = 'default') {\n    this.replaceState({\n      ...this.page,\n      rememberedState: {\n        ...this.page.rememberedState,\n        [key]: data,\n      },\n    })\n  },\n\n  restore(key = 'default') {\n    return window.history.state?.rememberedState?.[key]\n  },\n\n  on(type, callback) {\n    const listener = event => {\n      const response = callback(event)\n      if (event.cancelable && !event.defaultPrevented && response === false) {\n        event.preventDefault()\n      }\n    }\n\n    document.addEventListener(`inertia:${type}`, listener)\n    return () => document.removeEventListener(`inertia:${type}`, listener)\n  },\n}\n","export default function debounce(fn, delay) {\n  let timeoutID = null\n  return function () {\n    clearTimeout(timeoutID)\n    timeoutID = setTimeout(() => fn.apply(this, arguments), delay)\n  }\n}\n","export default function shouldIntercept(event) {\n  const isLink = event.currentTarget.tagName.toLowerCase() === 'a'\n  return !(\n    (event.target && event.target.isContentEditable)\n    || event.defaultPrevented\n    || (isLink && event.which > 1)\n    || (isLink && event.altKey)\n    || (isLink && event.ctrlKey)\n    || (isLink && event.metaKey)\n    || (isLink && event.shiftKey)\n  )\n}\n"],"names":["modal","listener","show","html","JSON","stringify","page","document","createElement","innerHTML","querySelectorAll","forEach","a","setAttribute","this","style","position","width","height","padding","boxSizing","backgroundColor","zIndex","addEventListener","_this","hide","iframe","borderRadius","appendChild","body","prepend","overflow","contentWindow","open","write","outerHTML","close","hideOnEscape","bind","removeEventListener","event","keyCode","fireEvent","name","options","dispatchEvent","CustomEvent","fireFinishEvent","visit","detail","fireNavigateEvent","hrefToUrl","href","URL","window","location","mergeDataIntoQueryString","method","url","data","Object","keys","length","search","qs","deepmerge","parse","ignoreQueryPrefix","encode","urlWithoutHash","hash","resolveComponent","swapComponent","transformProps","activeVisit","visitId","init","initialPage","handleInitialPageVisit","setupEventListeners","isBackForwardVisit","handleBackForwardVisit","isLocationVisit","handleLocationVisit","setPage","fn","timeoutID","handlePopstateEvent","handleScrollEvent","clearTimeout","setTimeout","apply","arguments","scrollRegions","target","hasAttribute","saveScrollPositions","replaceState","Array","prototype","slice","call","map","region","top","scrollTop","left","scrollLeft","resetScrollPositions","documentElement","getElementById","scrollIntoView","restoreScrollPositions","index","history","state","performance","getEntriesByType","type","version","preserveScroll","then","_this2","locationVisit","sessionStorage","setItem","reload","error","getItem","removeItem","rememberedState","_window$history$state2","_window$history$state4","_this3","isLocationVisitResponse","response","status","headers","isInertiaResponse","createVisitId","cancelVisit","cancelled","interrupted","completed","cancelToken","cancel","onCancel","onFinish","finishVisit","replace","preserveState","only","onCancelToken","onBefore","onStart","onProgress","onSuccess","toLowerCase","cancelable","fireBeforeEvent","Axios","CancelToken","source","_this4","fireStartEvent","Proxy","params","token","Accept","X-Requested-With","X-Inertia","X-Inertia-Partial-Component","component","X-Inertia-Partial-Data","join","X-Inertia-Version","onUploadProgress","progress","percentage","Math","round","loaded","total","fireProgressEvent","Promise","reject","props","responseUrl","locationUrl","isCancel","throwError","fireErrorEvent","get","prop","includes","console","warn","resolve","_this5","pushState","clone","_this6","post","put","patch","remember","key","restore","_window$history$state5","_window$history$state6","on","callback","defaultPrevented","preventDefault","isLink","currentTarget","tagName","isContentEditable","which","altKey","ctrlKey","metaKey","shiftKey"],"mappings":"4VAAA,MAAe,CACbA,MAAO,KACPC,SAAU,KAEVC,cAAKC,cACiB,iBAATA,IACTA,gHAAqHC,KAAKC,UAAUF,IAGtI,IAAIG,EAAOC,SAASC,cAAc,QAClCF,EAAKG,UAAYN,EACjBG,EAAKI,iBAAiB,KAAKC,QAAQ,SAAAC,UAAKA,EAAEC,aAAa,SAAU,UAEjEC,KAAKd,MAAQO,SAASC,cAAc,OACpCM,KAAKd,MAAMe,MAAMC,SAAW,QAC5BF,KAAKd,MAAMe,MAAME,MAAQ,QACzBH,KAAKd,MAAMe,MAAMG,OAAS,QAC1BJ,KAAKd,MAAMe,MAAMI,QAAU,OAC3BL,KAAKd,MAAMe,MAAMK,UAAY,aAC7BN,KAAKd,MAAMe,MAAMM,gBAAkB,oBACnCP,KAAKd,MAAMe,MAAMO,OAAS,IAC1BR,KAAKd,MAAMuB,iBAAiB,QAAS,kBAAMC,EAAKC,SAEhD,IAAIC,EAASnB,SAASC,cAAc,UACpCkB,EAAOX,MAAMM,gBAAkB,QAC/BK,EAAOX,MAAMY,aAAe,MAC5BD,EAAOX,MAAME,MAAQ,OACrBS,EAAOX,MAAMG,OAAS,OACtBJ,KAAKd,MAAM4B,YAAYF,GAEvBnB,SAASsB,KAAKC,QAAQhB,KAAKd,OAC3BO,SAASsB,KAAKd,MAAMgB,SAAW,SAC/BL,EAAOM,cAAczB,SAAS0B,OAC9BP,EAAOM,cAAczB,SAAS2B,MAAM5B,EAAK6B,WACzCT,EAAOM,cAAczB,SAAS6B,QAE9BtB,KAAKb,SAAWa,KAAKuB,aAAaC,KAAKxB,MACvCP,SAASgB,iBAAiB,UAAWT,KAAKb,WAG5CwB,gBACEX,KAAKd,MAAMmC,UAAY,GACvBrB,KAAKd,MAAQ,KACbO,SAASsB,KAAKd,MAAMgB,SAAW,UAC/BxB,SAASgC,oBAAoB,UAAWzB,KAAKb,WAG/CoC,sBAAaG,GACW,KAAlBA,EAAMC,SACR3B,KAAKW,SCjDX,SAASiB,EAAUC,EAAMC,GACvB,OAAOrC,SAASsC,cACd,IAAIC,uBAAuBH,EAAQC,aAYvBG,EAAgBC,GAC9B,OAAON,EAAU,SAAU,CAAEO,OAAQ,CAAED,MAAAA,cAOzBE,EAAkB5C,GAChC,OAAOoC,EAAU,WAAY,CAAEO,OAAQ,CAAE3C,KAAAA,cCpB3B6C,EAAUC,GACxB,WAAWC,IAAID,EAAME,OAAOC,UAG9B,SAAgBC,EAAyBC,EAAQC,EAAKC,GAKpD,MAJe,QAAXF,GAAoBG,OAAOC,KAAKF,GAAMG,SACxCJ,EAAIK,OAASC,EAAG3D,UAAU4D,EAAUD,EAAGE,MAAMR,EAAIK,OAAQ,CAAEI,mBAAmB,IAASR,GAAO,CAAES,QAAQ,IACxGT,EAAO,IAEF,CAACD,EAAKC,YAGCU,EAAeX,GAG7B,OAFAA,EAAM,IAAIL,IAAIK,EAAIN,OACdkB,KAAO,GACJZ,kBCZM,CACba,iBAAkB,KAClBC,cAAe,KACfC,eAAgB,KAChBC,YAAa,KACbC,QAAS,KACTrE,KAAM,KAENsE,qBAAOC,IAAAA,YAA+BL,IAAAA,cAAeC,IAAAA,eACnD3D,KAAKyD,mBADaA,iBAElBzD,KAAK0D,cAAgBA,EACrB1D,KAAK2D,eAAiBA,EACtB3D,KAAKgE,uBAAuBD,GAC5B/D,KAAKiE,uBAGPD,gCAAuBxE,GACjBQ,KAAKkE,qBACPlE,KAAKmE,uBAAuB3E,GACnBQ,KAAKoE,kBACdpE,KAAKqE,oBAAoB7E,IAEzBA,EAAKoD,KAAOJ,OAAOC,SAASe,KAC5BxD,KAAKsE,QAAQ9E,IAEf4C,EAAkB5C,IAGpByE,mCClC+BM,EAC3BC,EDkCFhC,OAAO/B,iBAAiB,WAAYT,KAAKyE,oBAAoBjD,KAAKxB,OAClEP,SAASgB,iBAAiB,UCpCG8D,EDoCgBvE,KAAK0E,kBAAkBlD,KAAKxB,MCnCvEwE,EAAY,uCAEdG,aAAaH,GACbA,EAAYI,WAAW,kBAAML,EAAGM,MAAMnE,EAAMoE,IDgCoC,QAAM,IAGxFC,yBACE,OAAOtF,SAASG,iBAAiB,oBAGnC8E,2BAAkBhD,GACyB,mBAA9BA,EAAMsD,OAAOC,cAA+BvD,EAAMsD,OAAOC,aAAa,kBAC/EjF,KAAKkF,uBAITA,+BACElF,KAAKmF,kBACAnF,KAAKR,MACRuF,cAAeK,MAAMC,UAAUC,MAAMC,KAAKvF,KAAK+E,iBAAiBS,IAAI,SAAAC,GAClE,MAAO,CACLC,IAAKD,EAAOE,UACZC,KAAMH,EAAOI,kBAMrBC,sCACErG,SAASsG,gBAAgBJ,UAAY,EACrClG,SAASsG,gBAAgBF,WAAa,EACtC7F,KAAK+E,gBAAgBlF,QAAQ,SAAA4F,GAC3BA,EAAOE,UAAY,EACnBF,EAAOI,WAAa,IAEtB7F,KAAKkF,sBAED1C,OAAOC,SAASe,gBAClB/D,SAASuG,eAAexD,OAAOC,SAASe,KAAK8B,MAAM,QAAKW,mBAI5DC,6CACMlG,KAAKR,KAAKuF,eACZ/E,KAAK+E,gBAAgBlF,QAAQ,SAAC4F,EAAQU,GACpCV,EAAOE,UAAYjF,EAAKlB,KAAKuF,cAAcoB,GAAOT,IAClDD,EAAOI,WAAanF,EAAKlB,KAAKuF,cAAcoB,GAAOP,QAKzD1B,8BACE,OAAO1B,OAAO4D,QAAQC,OACjB7D,OAAO8D,aACP9D,OAAO8D,YAAYC,iBAAiB,cAAcvD,QACY,iBAA9DR,OAAO8D,YAAYC,iBAAiB,cAAc,GAAGC,MAG5DrC,gCAAuB3E,cACrBgD,OAAO4D,QAAQC,MAAMI,QAAUjH,EAAKiH,QACpCzG,KAAKsE,QAAQ9B,OAAO4D,QAAQC,MAAO,CAAEK,gBAAgB,IAAQC,KAAK,WAChEC,EAAKV,4BAITW,uBAAcjE,EAAK8D,GACjB,IACElE,OAAOsE,eAAeC,QAAQ,uBAAwBzH,KAAKC,UAAU,CAAEmH,eAAAA,KACvElE,OAAOC,SAASH,KAAOM,EAAIN,KACvBiB,EAAef,OAAOC,UAAUH,OAASiB,EAAeX,GAAKN,MAC/DE,OAAOC,SAASuE,SAElB,MAAOC,GACP,WAIJ7C,2BACE,IACE,OAAiE,OAA1D5B,OAAOsE,eAAeI,QAAQ,wBACrC,MAAOD,GACP,WAIJ5C,6BAAoB7E,sBACZqH,EAAgBvH,KAAK8D,MAAMZ,OAAOsE,eAAeI,QAAQ,yBAC/D1E,OAAOsE,eAAeK,WAAW,wBACjC3H,EAAKoD,KAAOJ,OAAOC,SAASe,KAC5BhE,EAAK4H,kCAAkB5E,OAAO4D,QAAQC,cAAfgB,EAAsBD,mBAAmB,GAChE5H,EAAKuF,gCAAgBvC,OAAO4D,QAAQC,cAAfiB,EAAsBvC,iBAAiB,GAC5D/E,KAAKsE,QAAQ9E,EAAM,CAAEkH,eAAgBG,EAAcH,iBAAkBC,KAAK,WACpEE,EAAcH,gBAChBa,EAAKrB,4BAKXsB,iCAAwBC,GACtB,OAAOA,GAAgC,MAApBA,EAASC,QAAkBD,EAASE,QAAQ,uBAGjEC,2BAAkBH,GAChB,aAAOA,SAAAA,EAAUE,QAAQ,cAG3BE,yBAEE,OADA7H,KAAK6D,QAAU,QACHA,SAGdiE,qBAAY5F,aAAS6F,UAAAA,oBAAmBC,YAAAA,iBAClC9F,GAAUA,EAAM+F,WAAc/F,EAAM6F,WAAc7F,EAAM8F,cAC1D9F,EAAMgG,YAAYC,SAClBjG,EAAMkG,WACNlG,EAAM+F,WAAY,EAClB/F,EAAM6F,UAAYA,EAClB7F,EAAM8F,YAAcA,EACpB/F,EAAgBC,GAChBA,EAAMmG,aAIVC,qBAAYpG,GACLA,EAAM6F,WAAc7F,EAAM8F,cAC7B9F,EAAM+F,WAAY,EAClB/F,EAAM6F,WAAY,EAClB7F,EAAM8F,aAAc,EACpB/F,EAAgBC,GAChBA,EAAMmG,aAIVnG,eAAMU,6BAeF,SAdFD,OAAAA,aAAS,YACTE,KAAAA,aAAO,SACP0F,QAAAA,oBACA7B,eAAAA,oBACA8B,cAAAA,oBACAC,KAAAA,aAAO,SACPd,QAAAA,aAAU,SACVe,cAAAA,aAAgB,iBAAO,UACvBC,SAAAA,aAAW,iBAAO,UAClBC,QAAAA,aAAU,iBAAO,UACjBC,WAAAA,aAAa,iBAAO,UACpBR,SAAAA,aAAW,iBAAO,UAClBD,SAAAA,aAAW,iBAAO,UAClBU,UAAAA,aAAY,iBAAO,QAGLpG,EADdC,EAASA,EAAOoG,cAC+B1G,EAAUO,GAAMC,GACzDX,EAAQ,CAAEU,IADfA,OACoBD,OAAAA,EAAQE,KADvBA,OAC6B0F,QAAAA,EAAS7B,eAAAA,EAAgB8B,cAAAA,EAAeC,KAAAA,EAAMd,QAAAA,EAASe,cAAAA,EAAeC,SAAAA,EAAUC,QAAAA,EAASC,WAAAA,EAAYR,SAAAA,EAAUD,SAAAA,EAAUU,UAAAA,GAE5J,IAAwB,IAApBH,EAASzG,IFpLjB,SAAgCA,GAC9B,OAAON,EAAU,SAAU,CAAEoH,YAAY,EAAM7G,OAAQ,CAAED,MAAAA,KEmLrB+G,CAAgB/G,GAAlD,CAIAlC,KAAK8H,YAAY9H,KAAK4D,YAAa,CAAEoE,aAAa,IAClDhI,KAAKkF,sBAEL,IAAIrB,EAAU7D,KAAK6H,gBAQnB,OAPA7H,KAAK4D,YAAc1B,EACnBlC,KAAK4D,YAAYsE,YAAcgB,EAAMC,YAAYC,SACjDV,EAAc,CAAEP,OAAQ,kBAAMkB,EAAKvB,YAAYuB,EAAKzF,YAAa,CAAEmE,WAAW,OFtKlF,SAA+B7F,GACtBN,EAAU,QAAS,CAAEO,OAAQ,CAAED,MAAAA,KEuKpCoH,CAAepH,GACf0G,EAAQ1G,OAEGqH,MACTL,EAAM,CACJvG,OAAAA,EACAC,IAAKW,EAAeX,GAAKN,KACzBO,KAAiB,QAAXF,EAAmB,GAAKE,EAC9B2G,OAAmB,QAAX7G,EAAmBE,EAAO,GAClCqF,YAAalI,KAAK4D,YAAYsE,YAAYuB,MAC1C9B,aACKA,GACH+B,OAAQ,mCACRC,mBAAoB,iBACpBC,aAAa,GACTnB,EAAKzF,OAAS,CAChB6G,8BAA+B7J,KAAKR,KAAKsK,UACzCC,yBAA0BtB,EAAKuB,KAAK,MAClC,GACAhK,KAAKR,KAAKiH,QAAU,CAAEwD,oBAAqBjK,KAAKR,KAAKiH,SAAY,IAEvEyD,iBAAkB,SAAAC,GAChBA,EAASC,WAAaC,KAAKC,MAAMH,EAASI,OAASJ,EAASK,MAAQ,KFlM9E,SAAkCL,GACzBvI,EAAU,WAAY,CAAEO,OAAQ,CAAEgI,SAAAA,KEkMjCM,CAAkBN,GAClBtB,EAAWsB,MAEZxD,KAAK,SAAAc,GACN,IAAK4B,EAAKzB,kBAAkBH,GAC1B,OAAOiD,QAAQC,OAAO,CAAElD,SAAAA,IAEtBgB,EAAKzF,QAAUyE,EAAS5E,KAAKiH,YAAcT,EAAK7J,KAAKsK,YACvDrC,EAAS5E,KAAK+H,WAAavB,EAAK7J,KAAKoL,MAAUnD,EAAS5E,KAAK+H,QAE/D,IAAMC,EAAcxI,EAAUoF,EAAS5E,KAAKD,KAK5C,OAJIA,EAAIY,OAASqH,EAAYrH,MAAQD,EAAeX,GAAKN,OAASuI,EAAYvI,OAC5EuI,EAAYrH,KAAOZ,EAAIY,KACvBiE,EAAS5E,KAAKD,IAAMiI,EAAYvI,MAE3B+G,EAAK/E,QAAQmD,EAAS5E,KAAM,CAAEgB,QAAAA,EAAS0E,QAAAA,EAAS7B,eAAAA,EAAgB8B,cAAAA,MACtE7B,KAAK,WAEN,OF5MC/E,EAAU,UAAW,CAAEO,OAAQ,CAAE3C,KE2MjB6J,EAAK7J,QACfsJ,EAAUO,EAAK7J,cACf,SAAAyH,GACP,GAAIoC,EAAKzB,kBAAkBX,EAAMQ,UAC/B,OAAO4B,EAAK/E,QAAQ2C,EAAMQ,SAAS5E,KAAM,CAAEgB,QAAAA,OAClCwF,EAAK7B,wBAAwBP,EAAMQ,UAAW,CACvD,IAAIqD,EAAczI,EAAU4E,EAAMQ,SAASE,QAAQ,uBAC/C/E,EAAIY,OAASsH,EAAYtH,MAAQD,EAAeX,GAAKN,OAASwI,EAAYxI,OAC5EwI,EAAYtH,KAAOZ,EAAIY,MAEzB6F,EAAKxC,cAAciE,EAAapE,YACvBO,EAAMQ,SAKf,OAAOiD,QAAQC,OAAO1D,GF3OvBrF,EAAU,UAAW,CAAEoH,YAAY,EAAM7G,OAAQ,CAAEsF,SEuO7BR,EAAMQ,aACzBvI,EAAME,KAAK6H,EAAMQ,SAAS5E,SAK7B8D,KAAK,WACN0C,EAAKf,YAAYpG,WACV,SAAA+E,GACP,IAAKiC,EAAM6B,SAAS9D,GAAQ,CAC1B,IAAM+D,WF1Pe/D,GAC7B,OAAOrF,EAAU,QAAS,CAAEoH,YAAY,EAAM7G,OAAQ,CAAE8E,MAAAA,KEyP7BgE,CAAehE,GAElC,GADAoC,EAAKf,YAAYpG,GACb8I,EACF,OAAON,QAAQC,OAAO1D,MAGxB,CACFiE,IAAK,SAASlG,EAAQmG,GAIpB,MAHI,CAAC,OAAQ,QAAS,WAAWC,SAASD,IACxCE,QAAQC,KAAK,sNAEgB,mBAAjBtG,EAAOmG,GACjBnG,EAAOmG,GAAM3J,KAAKwD,GAClBA,EAAOmG,QAMnB7G,iBAAQ9E,6BAA2G,SAAnGqE,QAAAA,aAAU7D,KAAK6H,sBAAiBU,QAAAA,oBAAiB7B,eAAAA,oBAAwB8B,cAAAA,gBACvF,OAAOkC,QAAQa,QAAQvL,KAAKyD,iBAAiBjE,EAAKsK,YAAYnD,KAAK,SAAAmD,GACjE,GAAIjG,IAAY2H,EAAK3H,QAAS,CAC5BrE,EAAKuF,cAAgBvF,EAAKuF,eAAiB,GAC3CvF,EAAK4H,gBAAkB5H,EAAK4H,iBAAmB,GAC/CoB,EAAyC,mBAAlBA,EAA+BA,EAAchJ,GAAQgJ,EAC5E9B,EAA2C,mBAAnBA,EAAgCA,EAAelH,GAAQkH,GAC/E6B,EAAUA,GAAWlG,EAAU7C,EAAKoD,KAAKN,OAASE,OAAOC,SAASH,MACxDkJ,EAAKrG,aAAa3F,GAAQgM,EAAKC,UAAUjM,GACnD,IAAMkM,EAAQpM,KAAK8D,MAAM9D,KAAKC,UAAUC,IACxCkM,EAAMd,MAAQY,EAAK7H,eAAe+H,EAAMd,OACxCY,EAAK9H,cAAc,CAAEoG,UAAAA,EAAWtK,KAAMkM,EAAOlD,cAAAA,IAAiB7B,KAAK,WAC5DD,GACH8E,EAAK1F,uBAEFyC,GACHnG,EAAkB5C,SAO5BiM,mBAAUjM,GACRQ,KAAKR,KAAOA,EACZgD,OAAO4D,QAAQqF,UAAUjM,EAAM,GAAIA,EAAKoD,MAG1CuC,sBAAa3F,GACXQ,KAAKR,KAAOA,EACZgD,OAAO4D,QAAQjB,aAAa3F,EAAM,GAAIA,EAAKoD,MAG7C6B,6BAAoB/C,cAClB,GAAoB,OAAhBA,EAAM2E,MAAgB,CACxB,IAAM7G,EAAOkC,EAAM2E,MACfxC,EAAU7D,KAAK6H,gBACnB,OAAO6C,QAAQa,QAAQvL,KAAKyD,iBAAiBjE,EAAKsK,YAAYnD,KAAK,SAAAmD,GAC7DjG,IAAY8H,EAAK9H,UACnB8H,EAAKnM,KAAOA,EACZmM,EAAKjI,cAAc,CAAEoG,UAAAA,EAAWtK,KAAAA,EAAMgJ,eAAe,IAAS7B,KAAK,WACjEgF,EAAKzF,yBACL9D,EAAkB5C,QAKxB,IAAMoD,EAAMP,EAAUrC,KAAKR,KAAKoD,KAChCA,EAAIY,KAAOhB,OAAOC,SAASe,KAC3BxD,KAAKmF,kBAAkBnF,KAAKR,MAAMoD,IAAKA,EAAIN,QAC3CtC,KAAK8F,wBAIToF,aAAItI,EAAKC,EAAWf,GAClB,gBADOe,IAAAA,EAAO,aAAIf,IAAAA,EAAU,SAChBI,MAAMU,OAAUd,GAASa,OAAQ,MAAOE,KAAAA,MAGtDmE,gBAAOlF,GACL,gBADKA,IAAAA,EAAU,SACHI,MAAMM,OAAOC,SAASH,UAAWR,GAAS4E,gBAAgB,EAAM8B,eAAe,MAG7FD,iBAAQ3F,EAAKd,SAEX,gBAFWA,IAAAA,EAAU,IACrBuJ,QAAQC,oHAA0GxJ,EAAQa,UAAU,2BACxHT,MAAMU,KAAO4F,eAAe,GAAS1G,GAASyG,SAAS,MAGrEqD,cAAKhJ,EAAKC,EAAWf,GACnB,gBADQe,IAAAA,EAAO,aAAIf,IAAAA,EAAU,SACjBI,MAAMU,KAAO4F,eAAe,GAAS1G,GAASa,OAAQ,OAAQE,KAAAA,MAG5EgJ,aAAIjJ,EAAKC,EAAWf,GAClB,gBADOe,IAAAA,EAAO,aAAIf,IAAAA,EAAU,SAChBI,MAAMU,KAAO4F,eAAe,GAAS1G,GAASa,OAAQ,MAAOE,KAAAA,MAG3EiJ,eAAMlJ,EAAKC,EAAWf,GACpB,gBADSe,IAAAA,EAAO,aAAIf,IAAAA,EAAU,SAClBI,MAAMU,KAAO4F,eAAe,GAAS1G,GAASa,OAAQ,QAASE,KAAAA,sBAGtED,EAAKd,GACV,gBADUA,IAAAA,EAAU,SACRI,MAAMU,KAAO4F,eAAe,GAAS1G,GAASa,OAAQ,aAGpEoJ,kBAASlJ,EAAMmJ,kBAAAA,IAAAA,EAAM,WACnBhM,KAAKmF,kBACAnF,KAAKR,MACR4H,qBACKpH,KAAKR,KAAK4H,wBACZ4E,GAAMnJ,UAKboJ,iBAAQD,WACN,gBADMA,IAAAA,EAAM,oBACLxJ,OAAO4D,QAAQC,iBAAf6F,EAAsB9E,wBAAtB+E,EAAwCH,IAGjDI,YAAG5F,EAAM6F,GACP,IAAMlN,EAAW,SAAAuC,GACf,IAAM+F,EAAW4E,EAAS3K,GACtBA,EAAMsH,aAAetH,EAAM4K,mBAAiC,IAAb7E,GACjD/F,EAAM6K,kBAKV,OADA9M,SAASgB,4BAA4B+F,EAAQrH,qBAChCM,SAASgC,+BAA+B+E,EAAQrH,8FEjYzBuC,GACtC,IAAM8K,EAAuD,MAA9C9K,EAAM+K,cAAcC,QAAQ3D,cAC3C,QACGrH,EAAMsD,QAAUtD,EAAMsD,OAAO2H,mBAC3BjL,EAAM4K,kBACLE,GAAU9K,EAAMkL,MAAQ,GACxBJ,GAAU9K,EAAMmL,QAChBL,GAAU9K,EAAMoL,SAChBN,GAAU9K,EAAMqL,SAChBP,GAAU9K,EAAMsL"}